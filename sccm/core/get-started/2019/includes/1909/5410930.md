---
author: mestew
ms.author: mstewart
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: include
ms.date: 09/26/2019
ms.collection: M365-identity-device-management
---

## <a name="bkmk_CMPivot"></a> Additional CMPivot Entities and Enhancements
<!--5410930-->
Based on user-voice feedback, we've added a number of new CMPivot entities and entity enhancements to aid in troubleshooting and hunting. We've included entities to query:

- Windows event logs ([WinEvent](#bkmk_WinEvent))
- File content ([FileContent](#bkmk_File))
- Dlls loaded by processes ([ProcessModule](#bkmk_ProcessModule))
- Azure Active Directory information ([AADStatus](#bkmk_AadStatus))
- Endpoint protection status ([EPStatus](#bkmk_EPStatus))
- Hidden and system files ([File](#bkmk_Other))

### <a name="bkmk_WinEvent"></a> WinEvent(\<logname>,[\<timespan>])

This entity is used to get events from event logs and event tracing log files. The entity gets data from event logs that are generated by the Windows Event Log technology; introduced in Windows Vista. The entity also gets events in log files generated by Event Tracing for Windows (ETW). WinEvent looks at events that have occurred within the last 24 hours by default. However, the 24-hour default can be overridden by including a timespan.

<pre><code Lang="Kusto">WinEvent('Microsoft-Windows-HelloForBusiness/Operational', 1d)
| where LevelDisplayName =='Error'
| summarize count() by Device
</code></pre>

### <a name="bkmk_File"></a> FileContent(\<filename>)

FileContent is used to get the contents of a text file.

```
FileContent('c:\\windows\\SMSCFG.ini')
| where Content startswith  'SMS Unique Identifier='
| project Device, SMSId= substring(Content,22)
```

### <a name="bkmk_ProcessModule"></a> ProcessModule(\<processname>)  

This entity is used to enumerate the modules (dlls) loaded by a given process. ProcessModule can be particularly useful when hunting for malware that hides in legitimate processes.  

```
ProcessModule('powershell')
| summarize count() by ModuleName
| order by count_ desc
```

### <a name="bkmk_AadStatus"></a> AadStatus

This entity can be used to get the current Azure Active Directory identity information from a device.

```
AadStatus
| project Device, IsAADJoined=iif( isnull(DeviceId),'No','Yes')
| summarize DeviceCount=count() by IsAADJoined
| render piechart
```

### <a name="bkmk_EPStatus"></a> EPStatus

EPStatus is used to get the status of antimalware software installed on the computer.

```
EPStatus
| project Device, QuickScanAge=datetime_diff('day',now(),QuickScanEndTime)
| summarize DeviceCount=count() by QuickScanAge
| order by QuickScanAge
| render barchart
```

### <a name="bkmk_Other"></a> Other enhancements

- We've updated the **CcmLog()** and **EventLog()** entities to only look at messages in the last 24 hours by default. This behavior can be overridden by passing in an optional timespan. For example, `CcmLog(‘Scripts’,1h)` will look at events in the last 1 hour.
- The **File()** entity has been updated to collect information about Hidden and System files, and include the MD5 hash. While an MD5 hash isn't as accurate as the SHA256 hash, it tends to be the commonly reported hash in most malware bulletins.  
