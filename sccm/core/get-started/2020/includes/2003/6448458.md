---
author: aczechowski
ms.author: aaroncz
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: include
ms.date: 03/27/2020
---

## <a name="bkmk_tsapi"></a> New SDK method for task sequence progress

<!--6448458-->

Some customers build custom task sequence interfaces using the [IProgressUI::ShowMessage method](/configmgr/develop/reference/core/clients/client-classes/iprogressui--showmessage-method), but it doesn't return a value for the user's response. Based on your [UserVoice feedback](https://configurationmanager.uservoice.com/forums/300492-ideas/suggestions/37304425-tsprogressui-showmessage-enable-output), this release adds the **IProgressUI::ShowMessageEx** method. This new method is similar to the existing method, but also includes a new integer result variable, **pResult**. The value of this variable is a standard [Windows message box return value](https://docs.microsoft.com/windows/win32/api/winuser/nf-winuser-messagebox#return-value).

The following PowerShell script sample shows how to use this method:

```PowerShell
$Message = "What do you want to do?"
$Title = "Our New API"
$Type = 1
$TaskSequenceProgressUi = New-Object -ComObject Microsoft.SMS.TSProgressUI
$Output = 0
$TaskSequenceProgressUi.ShowMessageEx($Message, $Title, $Type, [ref]$Output)
```

You can use a script like this in the [Run PowerShell Script](/configmgr/osd/understand/task-sequence-steps#BKMK_RunPowerShellScript) step in the task sequence.
