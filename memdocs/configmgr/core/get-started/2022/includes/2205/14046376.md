---
author: Banreet Kaur
ms.author: banreetkaur
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 05/17/2022
ms.localizationpriority: medium
---

## <a name="bkmk_powershell"></a> PowerShell release notes preview

<!--14046376-->

These release notes summarize changes to the Configuration Manager PowerShell cmdlets in this technical preview release.

For more information about PowerShell for Configuration Manager, see [Get started with Configuration Manager cmdlets](/powershell/sccm/overview).

### New cmdlets

#### Approve-CMOrchestrationGroupScript

This cmdlet would help user to approve orchestration group script.

```powershell
$referenceOG = Get-CMOrchestrationGroup -Name $Script:OGName
$preScript = $referenceOG | Get-CMOrchestrationGroupScript -ScriptType Pre
$preScript | Approve-CMOrchestrationGroupScript -Comment "Approve"

Approve-CMOrchestrationGroupScript -ScriptGuid $PreScript.ScriptGuid
```

#### Deny-CMOrchestrationGroupScript

This cmdlet would help user to deny orchestration group script.

```powershell
$referenceOG = Get-CMOrchestrationGroup -Name $Script:OGName
$preScript = $referenceOG | Get-CMOrchestrationGroupScript -ScriptType Pre
$preScript | Deny-CMOrchestrationGroupScript -Comment "Deny"

Deny-CMOrchestrationGroupScript -ScriptGuid $PreScript.ScriptGuid -Comment "Deny"
```

#### Get-CMOrchestrationGroupScript

This cmdlet would help user to get orchestration group script from specified orchestration group.

```powershell
$referenceOG = Get-CMOrchestrationGroup -Name $Script:OGName
$preScript = $referenceOG | Get-CMOrchestrationGroupScript -ScriptType Pre
```

#### Get-CMTrustedRootCertificationAuthority

This cmdlet would help user to get the certificates for trusted root certification authorities(CAs).

```powershell
$ci =Get-CMTrustedRootCertificationAuthority
$ci =Get-CMTrustedRootCertificationAuthority -ViewDetail
```

#### New-CMAADClientApplication

This cmdlet would help user to specify application details and sign in with Azure Active Directory admin credentials to create client application in the Azure Active Directory.

```powershell
$serverApp = New-CMAADServerApplication -AppName $appName
New-CMAADClientApplication -AppName $name -InputObject $serverApp
```

#### New-CMAADServerApplication

This cmdlet would help user to specify application details and sign in with Azure Active Directory admin credentials to create server application in the Azure Active Directory.

```powershell
New-CMAADServerApplication -AppName $appName
```

### Modified cmdlets

#### Add-CMManagementPoint

**Non-breaking changes**

Fixed the function to make the ClientConnectionTypes.InternetAndIntranet as default value when enable cloud gateway to align with UI.

#### Get-CMObjectSecurityScope

**Non-breaking changes**

Fixed the function to allow user to get the security scope of a specified folder object.

#### New-CMCloudManagementGateway

**Non-breaking changes**

Added parameter “VMSSVMSize” and “Version” to support creating a CMG using a Scale Set.

#### New-CMComplianceRuleRegistryKeyPermission

**Non-breaking changes**

Fixed an issue in OperandDataType property when create rule.

#### Set-CMClientSettingComplianceSetting

**Non-breaking changes**

Added new parameter “ScriptExecutionTimeoutSecs” to allow user to extend the DCM script execution timeout value.

#### Set-CMClientSettingComputerRestart

**Non-breaking changes**

Extended the validation range of the parameter “CountdownMins” and “RebootLogoffNotificationCountdownMins” to align with UI.
Added new parameter “CountdownIntervalMins” and “ServerRebootLowRight” to align with UI. 
Fixed an property name issue for the parameter “NoRebootEnforcement”.

### Common Fix 

Added folder support for Automatic  Deployment Rule in cmdlets:

New-CMFolder, Get-CMFolder, Set-CMFolder, Remove-CMFolder, Move-CMObject, Add-CMObjectSecurityScope and Remove-CMObjectSecurityScope.
