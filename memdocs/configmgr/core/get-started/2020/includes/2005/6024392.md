---
author: mestew
ms.author: mstewart
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: include
ms.date: 05/26/2020
---

## <a name="bkmk_cmpivot"></a> Tenant attach: CMPivot

Bring the power of CMPivot and real-time queries to the Microsoft Endpoint Manager admin center. Allow additional personas, like Helpdesk, to run CMPivot from the cloud against an individual Configuration Manager managed device. This gives all the traditional benefits of CMPivot, which allows IT Admins and other designated personas the ability to quickly assess the state of devices in their environment and take action.

For more information about CMPivot, see:
- [CMPivot sample scripts](../../../../../tenant-attach/cmpivot-samples-attached.md)
- [CMPivot overview](../../../../../tenant-attach/cmpivot-overview-attached.md).

### Try it out!

Try to complete the tasks. Then send [Feedback](../../technical-preview-2003.md#bkmk_feedback) with your thoughts on the feature.

#### Prerequisites

The following items are required to use CMPivot:

- A [tenant attached environment with uploaded devices](device-sync-actions.md).
- Upgrade the target devices to the latest version of the Configuration Manager client.  
- Target clients require a minimum of PowerShell version 4.
- To gather data for the following entities, target clients require PowerShell version 5.0:  
  - Administrators
  - Connection
  - IPConfig
  - SMBConfig

- Configuration Manager permissions for CMPivot:
  - **Read** permission on the **SMS Scripts** object
  - **Run Scripts** permission on the **Collection**.
    - Alternatively, you can use **Run CMPivot** on **Collection**.
    - **Run Scripts** is a super set of the **Run CMPivot** permission.
  - **Read** permission on **Inventory Reports**
  - The default scope.

#### Use CMPivot from the Microsoft Endpoint Manager admin center

1. In the [Microsoft Endpoint Manager admin center](https://devicemanagement.microsoft.com), select a tenant attached device from **Devices** > **All devices**.
2. Select **CMPivot**, type your query in the script pane, then click **Run**.
   - For query examples, see [CMPivot sample scripts](../../../../../tenant-attach/cmpivot-samples-attached.md).
   -  For information about CMPivot entities, operators, and functions, see [CMPivot overview](../../../../../tenant-attach/cmpivot-overview-attached.md).
